<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:Lazy.Photos.App"
             x:Class="Lazy.Photos.App.MainPage"
             Title="Photos">

    <Grid RowDefinitions="Auto,Auto,*">
        <Grid Padding="12" ColumnDefinitions="*,Auto">
            <Label Text="Photos"
                   FontSize="22"
                   FontAttributes="Bold"
                   VerticalOptions="Center" />
            <Button Grid.Column="1"
                    Text="Refresh"
                    Command="{Binding RefreshCommand}" />
        </Grid>

        <Label Grid.Row="1"
               Padding="12,0"
               Text="{Binding ErrorMessage}"
               TextColor="#B00020"
               IsVisible="{Binding HasError}" />

        <RefreshView Grid.Row="2"
                     IsRefreshing="{Binding IsBusy}"
                     Command="{Binding RefreshCommand}">
            <CollectionView ItemsSource="{Binding Photos}"
                            Margin="8"
                            SelectionMode="None">
                <CollectionView.ItemsLayout>
                    <GridItemsLayout Orientation="Vertical"
                                     Span="{Binding Columns}"
                                     HorizontalItemSpacing="2"
                                     VerticalItemSpacing="2" />
                </CollectionView.ItemsLayout>
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Grid>
                            <Image Source="{Binding Thumbnail}"
                                   Aspect="AspectFill"
                                   HeightRequest="{Binding BindingContext.CellSize, Source={RelativeSource AncestorType={x:Type local:MainPage}}}"
                                   WidthRequest="{Binding BindingContext.CellSize, Source={RelativeSource AncestorType={x:Type local:MainPage}}}" />
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
                <CollectionView.EmptyView>
                    <Label Text="No photos found on this device."
                           Padding="12"
                           HorizontalTextAlignment="Center"
                           VerticalTextAlignment="Center" />
                </CollectionView.EmptyView>
            </CollectionView>
        </RefreshView>
    </Grid>

</ContentPage>
